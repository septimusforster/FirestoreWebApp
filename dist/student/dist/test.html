<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test</title>
    <link rel="stylesheet" href="../style/test.css">
    <!-- <script type="module" src="../src/test_bundle.js"></script> -->
</head>
<body>
    <dialog id="chkDateDialog">
        <output></output>
        <button type="button" id="okay" class="okay in-blk" onclick="dialogOKAY()">OKAY</button>
    </dialog>
    <dialog id="accDialog">
        <form action="#" name="accForm">
            <input type="text" name="acc" id="acc" class="in-blk" placeholder="Enter access token" spellcheck="false" autocomplete="off"/>
            <input type="submit" class="in-blk" value="Check"/>
        </form>
    </dialog>
    <dialog id="msgDialog">
        <output></output>
        <button class="okay" onclick="dialogOKAY()">OKAY</button>
    </dialog>
    <dialog id="submitDialog">
        <output>You clicked SUBMIT.<br/>Are you sure?</output>
        <button type="button" id="yes">YES</button>
        <button type="button" onclick="this.parentElement.close()">NO</button>
    </dialog>
    <header style="display:none;" class="disp">
        <img src="../img/9035117_person_icon.png" alt="Student photo">
        <span id="person"></span>
        <img src="../img/1737368_comment_description_outline_problem_task_icon.png" alt="Subject">
        <span id="task"></span>
        <!-- <img src="../img/185095_settings_icon.png" alt="Timer"> -->
        <div><span id="timer"></span><small>mins</small></div>
    </header>
    <section style="display:none;" class="disp">
        <h2>Instructions</h2>
        <span class="times sectionX">&times;</span>
    </section>
    <main style="display:none;" class="disp">
        <iframe src="iframe.html" width="400" height="800" name="docFrame"></iframe>
        <!-- <embed src="" width="400" height="800" name="docFrame" type="application/pdf"/> -->
        <aside>
            <div class="aside__header">
                Answer Sheet
            </div>
            <form class="aside__form" name="quizForm">
                <table>
                    <tbody>
                        
                    </tbody>
                </table>
                <div class="aside__footer">
                    <!-- <input type="submit" value="Submit"> -->
                    <input type="submit" value="SUBMIT" />
                </div>
            </form>
        </aside>
    </main>
    <script>
        const times = document.querySelectorAll('.times');
        times.forEach(time => {
            time.addEventListener('click', (e) => {
                time.parentElement.remove();
            })
        })

        function dialogOKAY() {
            // window.sessionStorage.remove();
            window.location.replace("./index.html");
        }

        const params = atob(new URL(location.href).searchParams.get('sb'));
        const ct = parseInt(new URL(location.href).searchParams.get('ct'));
        const subby = JSON.parse(sessionStorage.getItem(params));
        let cat;
        subby.forEach((sb, n) => {
            if (sb.catNo == ct) {
                cat = n;
                return;
            }
        })
        const link = subby[cat].link + '#toolbar=0';
        var iframe = document.querySelector('[name="docFrame"]');

        iframe.onload = function() {
            iframe.contentWindow.postMessage(link, location.origin);
        };
    </script>
    <script type="module" src="../src/test_bundle.js" defer></script>
</body>
</html>